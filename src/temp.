
add_executable(htj2k_decoder jsdecoder.cpp)
target_link_libraries(htj2k_decoder PRIVATE openjphsimd)
target_compile_options(htj2k_decoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_decoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_decoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=0 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=0 \
   ")


add_executable(htj2k_es6_decoder jsdecoder.cpp)
target_link_libraries(htj2k_es6_decoder PRIVATE openjphsimd)
target_compile_options(htj2k_es6_decoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_es6_decoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_es6_decoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=1 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=0 \
   ")


add_executable(htj2k_inline_decoder jsdecoder.cpp)
target_link_libraries(htj2k_inline_decoder PRIVATE openjphsimd)
target_compile_options(htj2k_inline_decoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_inline_decoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_inline_decoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=0 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=1 \
   ")

add_executable(htj2k_inline_es6_decoder jsdecoder.cpp)
target_link_libraries(htj2k_inline_es6_decoder PRIVATE openjphsimd)
target_compile_options(htj2k_inline_es6_decoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_inline_es6_decoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_inline_es6_decoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=1 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=1 \
   ")






# encoder




add_executable(htj2k_encoder jsencoder.cpp)
target_link_libraries(htj2k_encoder PRIVATE openjphsimd)
target_compile_options(htj2k_encoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_encoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_encoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=0 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=0 \
   ")


add_executable(htj2k_es6_encoder jsencoder.cpp)
target_link_libraries(htj2k_es6_encoder PRIVATE openjphsimd)
target_compile_options(htj2k_es6_encoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_es6_encoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_es6_encoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=1 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=0 \
   ")


add_executable(htj2k_inline_encoder jsencoder.cpp)
target_link_libraries(htj2k_inline_encoder PRIVATE openjphsimd)
target_compile_options(htj2k_inline_encoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_inline_encoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_inline_encoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=0 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=1 \
   ")

add_executable(htj2k_inline_es6_encoder jsencoder.cpp)
target_link_libraries(htj2k_inline_es6_encoder PRIVATE openjphsimd)
target_compile_options(htj2k_inline_es6_encoder PRIVATE -DOJPH_ENABLE_WASM_SIMD -msimd128)
target_compile_features(htj2k_inline_es6_encoder PUBLIC cxx_std_11)
set_target_properties(
    htj2k_inline_es6_encoder 
    PROPERTIES 
    LINK_FLAGS "\
      --bind \
      --allowJs \
      --emit-tsd interface.d.ts \
      -s DISABLE_EXCEPTION_CATCHING=1 \
      -s ASSERTIONS=0 \
      -s NO_EXIT_RUNTIME=1 \
      -s MALLOC=emmalloc \
      -s ALLOW_MEMORY_GROWTH=1 \
      -s TOTAL_MEMORY=50mb \
      -s FILESYSTEM=0 \
      -s EXPORTED_FUNCTIONS=[] \
      -s EXPORTED_RUNTIME_METHODS=[ccall] \
      -s MODULARIZE=1 \
      -s EXPORT_ES6=1 \
      -s EXPORT_NAME=OpenJPHDecoder \
      -s SINGLE_FILE=1 \
   ")
